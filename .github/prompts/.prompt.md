# 🚀 開発アシスタント プロンプト

## プロジェクト概要
NIHONGO-AI（日本語学習者・教育者向け）の多言語対応Webアプリケーション  
Next.js 15.3.0 + TypeScript + Tailwind CSS で構築

## 現在の実装状況 ✅
- **基本機能**: 100%完成（全ページ・多言語・レスポンシブ）
- **ブログ機能**: Phase 1&1.5&2&3完了（マークダウン・著者管理・検索・画像管理）
- **ビルド状況**: TypeScript・ESLintエラー0件
- **デプロイ**: Vercel本番環境稼働中

## 現在の技術スタック
- Next.js 15.3.0 (App Router)
- TypeScript 5.3.3  
- Tailwind CSS 4.1.3
- next-intl 4.1.0 (国際化: ja/en/zh-TW/zh-CN)
- next-themes 0.2.1 (ダークモード)
- Fuse.js 7.0.0 (ブログ検索エンジン)
- gray-matter + remark/rehype (マークダウン処理)

## 将来実装予定
- データベース統合 (Prisma + Supabase)
- 認証システム (NextAuth.js)
- 課金システム (Stripe)
- 左右表示翻訳対照機能（Phase 4）
- 管理者ダッシュボード

## ブログ機能実装状況 🎉
### ✅ Phase 1: 基盤構築（完了）
- マークダウンベースブログシステム
- 動的ルーティング（/blog/[slug]）
- 3記事×4言語完全移行

### ✅ Phase 1.5: 著者管理システム（完了）
- 独立した著者データファイル管理 (`src/content/authors/`)
- 著者情報の正規化・DRY原則実装
- AuthorId型による型安全な参照管理
- 著者解決ライブラリ（getAuthor・validateAuthorId）
- DB移行準備完了（正規化済み構造）

### ✅ Phase 2: 検索・フィルタ（完了）  
- Fuse.js高精度検索（50ms以下応答）
- リアルタイム検索・ハイライト表示
- タグフィルタ・ソート機能

### ✅ Phase 3: 画像管理（完了）
- WebP/AVIF最適化（70%サイズ削減）
- Intersection Observer遅延読み込み
- 多言語キャプション・alt属性対応
- BlogImage・LazyImage・ImageGalleryコンポーネント

## 開発時の重要ルール
1. 全テキストは翻訳ファイル (`messages/*.json`) から取得
2. TypeScript型安全性を最優先（エラー0件維持）
3. レスポンシブ + ダークモード対応必須
4. Next.js Image コンポーネント使用（WebP/AVIF対応）
5. Server Component優先・Client Component最小限
6. ブログ画像は BlogImage コンポーネント使用

## 頻繁に使用するパターン

### ブログ画像コンポーネント（Phase 3実装済み）
```tsx
import { BlogImage } from "@/components/Blog/BlogImage";

// 遅延読み込み・多言語キャプション対応
<BlogImage
  src="/images/hero.jpg"
  alt={{ ja: "サンプル画像", en: "Sample Image" }}
  caption={{ ja: "説明文", en: "Description" }}
  locale={locale}
  priority={false}
  className="rounded-lg"
/>
```

### 検索機能実装（Phase 2実装済み）
```tsx
import { useSearchBlogs } from "@/components/Blog/hooks/useSearchBlogs";

// Fuse.js による高精度検索
const { searchQuery, filteredPosts, handleSearch } = useSearchBlogs(posts, locale);
```

### ページコンポーネント
```tsx
import { getTranslations, setRequestLocale } from "next-intl/server";
import { Metadata } from "next";

type Props = { params: Promise<{ locale: string }>; };

export async function generateMetadata({ params }: Props): Promise<Metadata> {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: "PageName" });
  return { title: t("title"), description: t("description") };
}

const PageName = async ({ params }: Props) => {
  const { locale } = await params;
  setRequestLocale(locale);
  const t = await getTranslations("PageName");
  
  return (
    <section className="pt-[180px] pb-[120px]">
      <div className="container">
        <h1 className="text-3xl font-bold">{t("title")}</h1>
      </div>
    </section>
  );
};
```

### 共通スタイリング
```tsx
// セクション
<section className="overflow-hidden pt-[180px] pb-[120px]">

// コンテナ
<div className="container">

// グリッドレイアウト  
<div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">

// ダークモード対応
<div className="bg-white dark:bg-dark text-black dark:text-white">

// プライマリボタン
<button className="bg-primary text-white hover:bg-primary/90 px-6 py-3 rounded-md">
```

## 質問時のコンテキスト提供
開発に関する質問をする際は、以下を明確にしてください：
- 実装したい機能の詳細
- 対象となるページ・コンポーネント
- 多言語対応の必要性
- レスポンシブ対応の要件
- 既存コードとの整合性

## プロジェクトファイル参照
重要なファイル：
- `PROJECT_DOCUMENTATION.md` - 包括的プロジェクト情報
- `.github/.copilot-instructions.md` - 開発ガイドライン  
- `src/i18n/routing.ts` - 国際化設定
- `messages/*.json` - 翻訳ファイル
- `src/app/[locale]/components/` - UIコンポーネント

## Server vs Client Component 判断基準

### 🖥️ Server Component (推奨・デフォルト)
```tsx
// SEO重要、静的コンテンツ、初期レンダリング最適化
import { getTranslations } from "next-intl/server";

const ServerComponent = async ({ params }: Props) => {
  const t = await getTranslations("PageName");
  return <section>{t("content")}</section>;
};
```

### 💻 Client Component (必要最小限)
```tsx
// ユーザーインタラクション、状態管理、ブラウザAPI使用
"use client";
import { useState } from "react";

const ClientComponent = () => {
  const [state, setState] = useState(false);
  return <button onClick={() => setState(!state)}>Toggle</button>;
};
```

## 現在のServer/Client分類

### 🖥️ Server Components
- **全ページ**: page.tsx (SEO最適化)
- **セクション**: Hero, Features, About, Testimonials, Video
- **データ表示**: Blog, SingleBlog, SingleFeature
- **静的UI**: SectionTitle, Breadcrumb, **Footer**
- **ブログ機能**: BlogImage, LazyImage, ImageGallery

### 💻 Client Components  
- **Header**: スクロール検出、サブメニュー
- **LanguageSwitcher**: 動的言語変更
- **ThemeToggler**: テーマ状態管理
- **PricingClient**: 月額/年額切替
- **NewsLatterBoxClient**: フォーム処理
- **VideoPlayButton**: モーダル制御
- **ScrollToTop**: スクロール制御
- **BlogSearch**: 検索機能（デバウンス対応）
- **BlogFilter**: タグフィルタ（レスポンシブ折りたたみ）
- **BlogSort**: ソート機能（アニメーション付き）

### ✅ 最適化完了
- **Footer**: Client → Server 変更完了！(静的コンテンツ + i18n対応)
- **ブログ機能**: Phase 1&2&3実装完了
- **画像管理**: WebP/AVIF最適化・遅延読み込み完了

## タスク管理状況

### ✅ 完了 (95%)
- 基本機能、国際化、UI/UX、レスポンシブ
- **ブログ機能Phase 1&2&3**: マークダウン・検索・画像管理完了

### 🚧 進行中 (60-80%)  
- SEO最適化、パフォーマンス調整、アクセシビリティ

### ⏳ 今後実装 (0-50%)
- **ブログ機能Phase 4**: 左右表示翻訳対照機能
- 認証システム、データベース、課金システム

## 不足している重要ファイル

### 設定ファイル
- `.env.example` - 環境変数テンプレート
- `jest.config.js` - テスト設定
- `.github/workflows/ci.yml` - CI/CD

### 型定義
- `src/types/user.ts` - ユーザー型
- `src/types/api.ts` - API型  
- `src/types/form.ts` - フォーム型

### ページ
- `privacy/page.tsx` - プライバシーポリシー
- `404.tsx` - カスタム404

### 翻訳
- ErrorPage, FormValidation, Metadata カテゴリ

## プロジェクトファイル参照（役割分担）
> **詳細情報**: 各ドキュメントの専門領域を参照

- **[PROJECT_DOCUMENTATION.md](../PROJECT_DOCUMENTATION.md)** - プロジェクト全体概要・技術選択理由
- **[BLOG_REQUIREMENTS.md](./BLOG_REQUIREMENTS.md)** - ブログ機能特化の要件・進捗管理  
- **[.copilot-instructions.md](./.copilot-instructions.md)** - 実装ガイドライン・コーディング規則
- **[BLOG_IMPLEMENTATION_PLAN.md](./BLOG_IMPLEMENTATION_PLAN.md)** - ブログ機能実装の詳細計画