# 🚀 GitHub Copilot 開発実装ガイド

> **⚙️ 目的**: Next.js多言語対応Webアプリケーション開発のための実装ルールとワークフロー  
> **🎯 対象**: GitHub Copilot、実際にコードを書く開発者、実装を行うAI  
> **📖 補完資料**: [PROJECT_DOCUMENTATION.md](../PROJECT_DOCUMENTATION.md) でプロジェクト全体像を確認  
> **🔄 最終更新**: 2025年1月28日

---

## 📋 **1. プロジェクト基本情報**

> **📖 詳細**: [PROJECT_DOCUMENTATION.md](../PROJECT_DOCUMENTATION.md) の「プロジェクト概要・技術スタック」を参照

### 1.1 実装に必要な基本知識
- **プロダクト**: スタートアップ・SaaS企業向け多言語対応Webアプリケーション
- **現状**: Next.jsテンプレートベースの静的サイト（95%完成）
- **技術**: Next.js 15 + TypeScript + Tailwind CSS + next-intl

### 1.2 実装時の必須チェック項目
```yaml
実装前チェック:
  ✅ 翻訳対応: 表示テキストは必ずmessages/*.jsonから取得
  ✅ 型安全性: TypeScriptエラー0件を維持
  ✅ コンポーネント分類: Server/Client適切な選択
  ✅ レスポンシブ: モバイルファースト対応

実装後チェック:
  ✅ ビルド成功: npm run build エラーなし
  ✅ リント通過: npm run lint エラーなし
  ✅ 動作確認: 全言語・全画面サイズで表示確認
```

---

## 🏗️ **2. アーキテクチャ設計規則**

### 2.1 ディレクトリ構造
```
src/app/[locale]/
├── 📄 layout.tsx              # ルートレイアウト（Server）
├── 📄 page.tsx                # ホームページ（Server）
├── 📄 ClientLayout.tsx        # クライアントレイアウト（Client）
├── 📄 providers.tsx           # テーマプロバイダー（Client）
├── 📁 components/
│   ├── 📁 Header/             # ナビゲーション（Client）
│   ├── 📁 Footer/             # フッター（Server）
│   ├── 📁 Common/             # 共通コンポーネント（Server）
│   └── 📁 [FeatureName]/      # 機能別コンポーネント
└── 📁 [page-name]/
    └── 📄 page.tsx            # ページコンポーネント（Server）
```

### 2.2 Server vs Client Component分類（最適化済み✅）

#### 🖥️ **Server Components**（推奨・デフォルト）
**適用条件**:
- 静的コンテンツ表示
- SEO重要（メタデータ、構造化データ）
- 初期レンダリング最適化
- データフェッチ（API、DB）
- サーバー側翻訳

**実装例**:
```tsx
import { getTranslations } from "next-intl/server";

const ServerComponent = async ({ params }: Props) => {
  const t = await getTranslations("PageName");
  return <section>{t("content")}</section>;
};
```

**適用コンポーネント**:
- **ページ**: 全page.tsx
- **セクション**: Hero, Features, About, Testimonials, Video, Footer
- **データ表示**: Blog, SingleBlog, SingleFeature
- **静的UI**: SectionTitle, Breadcrumb

#### 💻 **Client Components**（必要最小限）
**適用条件**:
- ユーザーインタラクション（クリック、ホバー、スクロール）
- 状態管理（useState, useReducer）
- ブラウザAPI（localStorage, window）
- フォーム処理（バリデーション、送信）
- 動的UI（モーダル、ドロップダウン）

**実装例**:
```tsx
"use client";
import { useState } from "react";

const ClientComponent = () => {
  const [state, setState] = useState(false);
  return <button onClick={() => setState(!state)}>Toggle</button>;
};
```

**適用コンポーネント**:
- **インタラクション**: Header, LanguageSwitcher, ThemeToggler
- **フォーム**: NewsLatterBoxClient, PricingClient
- **UI制御**: VideoPlayButton, ScrollToTop, video-modal

---

## 🌐 **3. 国際化（i18n）実装規則**

### 3.1 サポート言語・設定
```typescript
// src/i18n/routing.ts
export const routing = defineRouting({
  locales: ['ja', 'en', 'zh-TW', 'zh-CN'],
  defaultLocale: 'ja'
});
```

### 3.2 実装パターン

#### **Server Component での翻訳**
```tsx
import { getTranslations, setRequestLocale } from "next-intl/server";

const ServerPage = async ({ params }: Props) => {
  const { locale } = await params;
  setRequestLocale(locale);
  const t = await getTranslations("PageName");
  
  return <h1>{t("title")}</h1>;
};
```

#### **Client Component での翻訳**
```tsx
"use client";
import { useTranslations } from 'next-intl';

const ClientComponent = () => {
  const t = useTranslations('PageName');
  return <h1>{t('title')}</h1>;
};
```

### 3.3 翻訳ファイル管理
```
messages/
├── ja.json      # 日本語（デフォルト）
├── en.json      # 英語
├── zh-TW.json   # 繁体中国語
└── zh-CN.json   # 簡体中国語
```

---

## 🎨 **4. スタイリング・UI設計規則**

### 4.1 Tailwind CSS 使用パターン
```tsx
// ✅ 推奨パターン
// レスポンシブ + コンテナ
<div className="container mx-auto px-4 lg:px-8">
  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">

// ダークモード対応
<div className="bg-white dark:bg-dark text-black dark:text-white">

// インタラクティブ要素
<button className="bg-primary text-white hover:bg-primary/90 px-6 py-3 rounded-md transition-colors">

// セクション構造
<section className="overflow-hidden pt-[180px] pb-[120px]">
  <div className="container">
    <!-- コンテンツ -->
  </div>
</section>
```

### 4.2 コンポーネント設計原則
1. **再利用可能性**: `Common/`フォルダに共通コンポーネント配置
2. **責任分離**: UI・ロジック・データ取得を分離
3. **型安全性**: 全propsにTypeScript型定義
4. **アクセシビリティ**: WCAG 2.1 AA準拠
5. **レスポンシブ**: モバイルファースト設計

---

## � **5. 開発ワークフロー・実装手順**

### 5.1 新規ページ作成手順
```bash
# 1. ディレクトリ作成
mkdir -p src/app/[locale]/[page-name]

# 2. page.tsx実装
```

```tsx
// src/app/[locale]/[page-name]/page.tsx
import { getTranslations, setRequestLocale } from "next-intl/server";
import { Metadata } from "next";

type Props = {
  params: Promise<{ locale: string }>;
};

export async function generateMetadata({ params }: Props): Promise<Metadata> {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: "PageName" });
  return {
    title: t("title"),
    description: t("description"),
  };
}

const PageName = async ({ params }: Props) => {
  const { locale } = await params;
  setRequestLocale(locale);
  const t = await getTranslations("PageName");

  return (
    <section className="overflow-hidden pt-[180px] pb-[120px]">
      <div className="container">
        <h1>{t("title")}</h1>
      </div>
    </section>
  );
};

export default PageName;
```

```json
// 3. 翻訳追加 (messages/ja.json)
{
  "PageName": {
    "title": "ページタイトル",
    "description": "ページ説明"
  }
}
```

### 5.2 新規コンポーネント作成手順
1. **TypeScript型定義**: 明確なprops型定義
2. **翻訳対応**: 表示テキストは翻訳ファイルから取得
3. **レスポンシブ**: モバイルファースト設計
4. **アクセシビリティ**:適切な属性設定

### 5.3 Git ワークフロー
```bash
# 1. ブランチ作成
git checkout -b feature/[機能名]

# 2. 開発・テスト
npm run lint           # ESLint チェック
npm run build          # ビルド確認
npm run type-check     # 型チェック（追加予定）

# 3. コミット
git add .
git commit -m "feat: 新機能追加"

# 4. プルリクエスト作成
```

---

## � **6. 必須実装ルール・品質基準**

### 6.1 絶対禁止事項
- ❌ **ハードコーディングテキスト**: 全テキストは翻訳ファイルから取得
- ❌ **any型使用**: TypeScript型安全性の確保
- ❌ **TypeScriptエラー**: ビルド時エラーは許可しない
- ❌ **コンソールエラー**: 運用環境でのエラー出力禁止
- ❌ **不要なClient Component**: 必要最小限に限定

### 6.2 必須対応事項
- ✅ **多言語対応**: 全コンポーネントでi18n実装
- ✅ **レスポンシブ**: 全画面サイズ対応
- ✅ **ダークモード**: 全UIでテーマ対応
- ✅ **画像最適化**: Next.js Image コンポーネント使用
- ✅ **アクセシビリティ**: WCAG 2.1 AA準拠

### 6.3 コミット規則
```
feat: 新機能追加
fix: バグ修正
docs: ドキュメント更新
style: コードスタイル修正（機能変更なし）
refactor: リファクタリング（機能変更なし）
test: テスト追加・修正
chore: その他の作業（依存関係更新等）
```

---

## 🔧 **7. 開発効率化・追加推奨ツール**

### 7.1 追加すべきnpmスクリプト
```json
{
  "scripts": {
    "type-check": "tsc --noEmit",
    "test": "jest",
    "test:watch": "jest --watch",
    "test:e2e": "playwright test",
    "build:analyze": "ANALYZE=true npm run build",
    "clean": "rm -rf .next out",
    "db:generate": "prisma generate",
    "db:push": "prisma db push"
  }
}
```

### 7.2 追加すべき開発ツール
```yaml
テスト:
  - jest + @testing-library/react  # 単体テスト
  - playwright                     # E2Eテスト

開発支援:
  - @next/bundle-analyzer         # バンドルサイズ分析
  - eslint-plugin-jsx-a11y        # アクセシビリティ
  - prettier-plugin-organize-imports # インポート整理

型定義:
  - @types/node                   # Node.js型定義
```

### 7.3 不足ファイル（作成推奨）
```
設定ファイル:
├── .env.example                 # 環境変数テンプレート
├── jest.config.js              # テスト設定
└── .github/workflows/ci.yml    # CI/CD

型定義:
├── src/types/user.ts           # ユーザー関連型
├── src/types/api.ts            # API型定義
└── src/types/form.ts           # フォーム型

ページ:
├── src/app/[locale]/pricing/page.tsx    # 料金ページ
├── src/app/[locale]/privacy/page.tsx    # プライバシーポリシー
└── src/app/[locale]/404.tsx             # カスタム404
```

---

## 📚 **8. 参考資料・重要ファイル**

### 8.1 プロジェクト内重要ファイル
- `PROJECT_DOCUMENTATION.md` - 包括的プロジェクト情報
- `src/i18n/routing.ts` - 国際化設定
- `messages/*.json` - 翻訳ファイル
- `src/app/[locale]/components/` - UIコンポーネント

### 8.2 質問・開発相談時の確認事項
開発に関する質問時は以下を明確化してください：
- **機能詳細**: 実装したい機能の具体的要件
- **対象範囲**: 影響するページ・コンポーネント
- **多言語**: 翻訳対応の必要性
- **レスポンシブ**: デバイス対応要件
- **整合性**: 既存コードとの互換性

---

> **� 重要**: この指示書に従って開発することで、一貫性のある高品質なコードを維持できます。疑問がある場合は、既存のコードパターンを参考にしてください。